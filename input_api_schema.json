{"openapi":"3.0.0","info":{"title":"Build Canada Hub API","version":"1.0.0","description":"API for uploading financial statements and updating body information","contact":{"name":"Build Canada","url":"https://buildcanadahub.ca"}},"servers":[{"url":"https://hub.buildcanada.com","description":"Production server"}],"security":[{"bearerAuth":[]}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"API Token","description":"API token from Build Canada Hub account settings"}},"schemas":{"Error":{"type":"object","properties":{"error":{"type":"string"},"details":{"oneOf":[{"type":"string"},{"type":"array","items":{"type":"string"}}]}},"required":["error"]},"FinancialStatementUploadResponse":{"type":"object","properties":{"id":{"type":"integer"},"body_id":{"type":"integer"},"census_subdivision_id":{"type":"string"},"body_name":{"type":"string"},"financial_year":{"type":"integer"},"uploaded_at":{"type":"string","format":"date-time"},"uploaded_by":{"type":"string"},"status":{"type":"string","enum":["validating"]},"message":{"type":"string"}}},"BodyUpdateResponse":{"type":"object","properties":{"census_subdivision_id":{"type":"string"},"name":{"type":"string"},"website_url":{"type":"string","nullable":true},"website_url_updated_by":{"type":"string","nullable":true},"website_url_updated_at":{"type":"string","format":"date-time"},"financial_statement_directory_url":{"type":"string","nullable":true},"financial_statement_directory_url_updated_by":{"type":"string","nullable":true},"message":{"type":"string"}}}}},"paths":{"/api/v1/bodies/{census_subdivision_id}/{year}":{"post":{"summary":"Upload financial statement PDF","description":"Upload a financial statement PDF for a specific body and year. The document will be validated using Gemini AI.","tags":["Financial Statements"],"parameters":[{"name":"census_subdivision_id","in":"path","required":true,"schema":{"type":"string"},"description":"Census subdivision ID of the body"},{"name":"year","in":"path","required":true,"schema":{"type":"integer","minimum":1900},"description":"Financial year (e.g., 2023)"}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"document":{"type":"string","format":"binary","description":"PDF file of the financial statement"}},"required":["document"]}}}},"responses":{"201":{"description":"Financial statement uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FinancialStatementUploadResponse"}}}},"400":{"description":"Bad request (invalid year, missing document, or invalid file type)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized (invalid or missing API token)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Body not found with given census_subdivision_id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"Conflict - financial statement already exists for this year","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/api/v1/bodies/{census_subdivision_id}":{"put":{"summary":"Update body URLs","description":"Update website URL and/or financial statement directory URL for a body. Either field can be updated independently.","tags":["Bodies"],"parameters":[{"name":"census_subdivision_id","in":"path","required":true,"schema":{"type":"string"},"description":"Census subdivision ID of the body"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"website_url":{"type":"string","format":"uri","description":"Body's main website URL","nullable":true},"financial_statement_directory_url":{"type":"string","format":"uri","description":"URL to the body's financial statements directory","nullable":true}},"minProperties":1}}}},"responses":{"200":{"description":"Body updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BodyUpdateResponse"}}}},"400":{"description":"Bad request (invalid URL format or no fields provided)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized (invalid or missing API token)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Body not found with given census_subdivision_id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}}}}